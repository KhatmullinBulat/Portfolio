"use strict";window.addEventListener("DOMContentLoaded",(function(){document.querySelector("#burger").addEventListener("click",(function(){document.querySelector("#menu").classList.toggle("menu__is-active")})),document.querySelector("#close-menu").addEventListener("click",(function(){document.querySelector("#menu").classList.toggle("menu__is-active")})),document.querySelector("#search").addEventListener("click",(function(){document.querySelector("#search-menu").classList.toggle("search-menu__is-active")})),document.querySelector("#close-search-menu").addEventListener("click",(function(){document.querySelector("#search-menu").classList.toggle("search-menu__is-active")})),$(document).ready((function(){$("#menu").on("click","a",(function(e){e.preventDefault();var t=$(this).attr("href"),a=$(t).offset().top;$("body,html").animate({scrollTop:a},1500)}))}));var e={btnClassName:"js-header-dropdown-btn",dropClassName:"js-header-drop",activeClassName:"is-active",disabledClassName:"is-disabled"};function t(a){a.target.classList.contains(e.disabledClassName)&&(a.target.classList.remove(e.disabledClassName,e.activeClassName),a.target.removeEventListener("animationend",t))}document.body.addEventListener("click",(function(a){var n=document.querySelectorAll(".".concat(e.btnClassName,".").concat(e.activeClassName,", .").concat(e.dropClassName,".").concat(e.activeClassName));if(n.length&&!a.target.closest(".".concat(e.activeClassName))&&n.forEach((function(t){t.classList.contains(e.btnClassName)?t.classList.remove(e.activeClassName):t.classList.add(e.disabledClassName)})),a.target.closest(".".concat(e.btnClassName))){var i=a.target.closest(".".concat(e.btnClassName)),o=i.dataset.path,s=document.querySelector(".".concat(e.dropClassName,'[data-target="').concat(o,'"]'));i.classList.toggle(e.activeClassName),s.classList.contains(e.activeClassName)?s.classList.add(e.disabledClassName):(s.classList.add(e.activeClassName),s.addEventListener("animationend",t))}})),$(".search-input").focus((function(){$(this).removeAttr("placeholder")})),$(".search-input").blur((function(){$(this).attr("placeholder","Поиск по сайту")}));new Swiper(".hero__swiper",{direction:"horizontal",loop:!0,allowTouchMove:!1,effect:"fade",autoplay:{delay:7e3}}),new Swiper(".gallery__slides-container",{slidesPerView:1,grid:{rows:1,fill:"row"},spaceBetween:20,pagination:{el:".gallery__swiper-pagination",type:"fraction"},navigation:{nextEl:".swiper-btn-next",prevEl:".swiper-btn-prev"},breakpoints:{440:{slidesPerView:2,grid:{rows:2},spaceBetween:30},1200:{slidesPerView:3,grid:{rows:2},spaceBetween:50}},a11y:!1,keyboard:!0,watchSlidesProgress:!0,watchSlidesVisibility:!0,slideVisibleClass:"slide-visible",on:{init:function(){this.slides.forEach((function(e){e.classList.contains("slide-visible")?e.tabIndex="":e.tabIndex="-1"}))},slideChange:function(){this.slides.forEach((function(e){e.classList.contains("slide-visible")?e.tabIndex="":e.tabIndex="-1"}))}}});var a,n=document.querySelector(".events__btn"),i=document.querySelector(".events__swiper"),o=document.querySelectorAll(".events__swiper-card-wrap");function s(){$(window).width()<732&&"false"==i.dataset.mobile&&(a=new Swiper(i,{slidesPerView:1,spaceBetween:20,autoHeight:!0,pagination:{el:".events__swiper-pagination",clickable:!0,bulletClass:"events__swiper-pagination-item",bulletActiveClass:"events__swiper-pagination-item-active",bulletElement:"li",modifierClass:"events-nav-"}}),i.dataset.mobile="true"),$(window).width()>=732&&"true"==i.dataset.mobile&&(i.dataset.mobile="false",i.classList.contains("swiper-initialized")&&(a.destroy(),a=void 0))}n.addEventListener("click",(function(){o.forEach((function(e){e.style.display="block"})),this.style.display="none"})),i.dataset.mobile=!1,s();var c,r=document.querySelector(".editions__swiper-wrap");function l(){$(window).width()>=610&&"false"==r.dataset.mobile&&(c=new Swiper(".editions__swiper-wrap",{direction:"horizontal",loop:!1,allowTouchMove:!1,speed:1e3,navigation:{nextEl:".editions__swiper-button-next",prevEl:".editions__swiper-button-prev"},pagination:{el:".editions__swiper-pagination",type:"fraction"},slidesPerView:2,slidesPerColumn:1,slidesPerGroup:1,spaceBetween:34,slidersPerColumnFill:"row",breakpoints:{1024:{slidesPerView:2,spaceBetween:50},1280:{slidesPerView:3,spaceBetween:50}}}),r.dataset.mobile=!0),$(window).width()<610&&"true"==r.dataset.mobile&&(r.dataset.mobile="false",r.classList.contains("swiper-initialized")&&(c.destroy(),c=void 0))}r.dataset.mobile=!1,l();new Swiper(".project-partners__swiper",{direction:"horizontal",loop:!1,allowTouchMove:!1,navigation:{nextEl:".project-partners__swiper-button-next",prevEl:".project-partners__swiper-button-prev"},speed:1e3,slidesPerView:1,slidesPerColumn:1,slidesPerGroup:1,slidersPerColumnFill:"row",breakpoints:{590:{slidesPerView:2,spaceBetween:34},1024:{slidesPerView:2,spaceBetween:50},1440:{slidesPerView:3,spaceBetween:50}}});var d=document.querySelectorAll(".gallery__swiper-slide"),u=document.querySelector(".gallery__modal-overlay"),m=document.querySelectorAll(".modal"),p=document.querySelectorAll(".modal__close-btn");d.forEach((function(e){e.addEventListener("click",(function(e){var t=e.currentTarget.getAttribute("data-path");m.forEach((function(e){e.classList.remove("modal--visible")})),document.querySelector('[data-target="'.concat(t,'"]')).classList.add("modal--visible"),u.classList.add("gallery__modal-overlay--visible")}))})),u.addEventListener("click",(function(e){e.target==u&&(u.classList.remove("gallery__modal-overlay--visible"),m.forEach((function(e){e.classList.remove("modal--visible")})))})),p.forEach((function(e){e.addEventListener("click",(function(e){u.classList.remove("gallery__modal-overlay--visible"),m.forEach((function(e){e.classList.remove("modal--visible")}))}))}));var v=document.querySelector(".gallery__filters-select-elements");new Choices(v,{searchEnabled:!1,itemSelectText:"",placeholder:!0,shouldSort:!1,position:"bottom"});document.querySelectorAll(".catalog__accordion-information-link").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.currentTarget.dataset.path;document.querySelectorAll(".catalog__artist").forEach((function(e){e.classList.remove("tab-content-active"),document.querySelectorAll(".catalog__accordion-information-link").forEach((function(e){e.classList.remove("tab-active")}))})),document.querySelector('[data-target="'.concat(t,'"]')).classList.add("tab-content-active"),document.querySelector('[data-path="'.concat(t,'"]')).classList.add("tab-active")}))})),$((function(){$("#accordion").accordion({collapsible:!0,icons:!1,heightStyle:"content"})}));var w=document.querySelector(".editions__category-btn"),f=document.querySelectorAll(".editions__category-content-item"),_=document.querySelectorAll(".editions__category-content-checkbox"),y=(this.document.querySelectorAll("editions__category-content-label"),document.querySelector(".editions__btn-arrow"));function g(){$(window).width()>=610&&_.forEach((function(e){!0===e.activeElement&&e.parentElement.parentNode.classList.add("editions__category-content-item-active-color"),!0===e.checked?e.parentElement.parentNode.classList.add("editions__category-content-item-active-color"):e.parentElement.parentNode.classList.remove("editions__category-content-item-active-color")}));var e=function(){_.forEach((function(e){!0===e.checked&&e.parentElement.parentNode.classList.add("editions__category-content-item-active","editions__category-content-item-active-color")}))};w.addEventListener("click",(function(){y.classList.toggle("editions__btn-arrow-active"),f.forEach((function(t){t.classList.toggle("editions__category-content-item-active"),e()}))})),function(){for(var t=function(){var t=_[a];t.addEventListener("change",(function(){t.checked||y.classList.contains("editions__btn-arrow-active")||t.parentElement.parentNode.classList.remove("editions__category-content-item-active","editions__category-content-item-active-color"),e()}))},a=0;a<_.length;a++)t();e()}()}g(),tippy("#tooltip-1",{content:function(e){var t=e.getAttribute("data-template");return document.getElementById(t).innerHTML},theme:"tomato",allowHTML:!0,animation:"fade",interactive:!0,arrow:!0}),tippy("#tooltip-2",{content:function(e){var t=e.getAttribute("data-template");return document.getElementById(t).innerHTML},theme:"tomato",allowHTML:!0,animation:"fade",interactive:!0,arrow:!0}),tippy("#tooltip-3",{content:function(e){var t=e.getAttribute("data-template");return document.getElementById(t).innerHTML},theme:"tomato",allowHTML:!0,animation:"fade",interactive:!0,arrow:!0}),ymaps.ready((function(){new ymaps.Map("map",{center:[55.758468,37.601088],controls:[],zoom:15})}));var b=document.querySelector("input[type='tel']");new Inputmask("+7 (999) - 999 - 99 - 99").mask(b),new JustValidate("#form",{rules:{name:{required:!0,minLength:2,maxLength:20},tel:{required:!0,function:function(e,t){var a=b.inputmask.unmaskedvalue();return Number(a)&&10===a.length}}},messages:{name:{required:"Это поле обязательное для заполнения",minLength:"Вы ввели слишком мало символов",maxLength:"Вы ввели слишком много символов"},tel:{required:"Это поле обязательное для заполнения",function:"Введите корректный номер телефона"}},submitHandler:function(e,t,a){a({url:"http://jsonplaceholder.typicode.com/posts",method:"POST",data:t,async:!0,callback:function(e){document.querySelector(".contacts__form-success-message").style.display="inline-block"}})}}),window.addEventListener("resize",(function(e){s(),g(),l()}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiLCJzY3JpcHQuanMiXSwibmFtZXMiOlsid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIiQiLCJyZWFkeSIsIm9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImlkIiwidGhpcyIsImF0dHIiLCJ0b3AiLCJvZmZzZXQiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwicGFyYW1zIiwiYnRuQ2xhc3NOYW1lIiwiZHJvcENsYXNzTmFtZSIsImFjdGl2ZUNsYXNzTmFtZSIsImRpc2FibGVkQ2xhc3NOYW1lIiwib25EaXNhYmxlIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYm9keSIsImFjdGl2ZUVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImNvbmNhdCIsImxlbmd0aCIsImNsb3Nlc3QiLCJmb3JFYWNoIiwiY3VycmVudCIsImFkZCIsImJ0biIsInBhdGgiLCJkYXRhc2V0IiwiZHJvcCIsImZvY3VzIiwicmVtb3ZlQXR0ciIsImJsdXIiLCJTd2lwZXIiLCJkaXJlY3Rpb24iLCJsb29wIiwiYWxsb3dUb3VjaE1vdmUiLCJlZmZlY3QiLCJhdXRvcGxheSIsImRlbGF5Iiwic2xpZGVzUGVyVmlldyIsImdyaWQiLCJyb3dzIiwiZmlsbCIsInNwYWNlQmV0d2VlbiIsInBhZ2luYXRpb24iLCJlbCIsInR5cGUiLCJuYXZpZ2F0aW9uIiwibmV4dEVsIiwicHJldkVsIiwiYnJlYWtwb2ludHMiLCJhMTF5Iiwia2V5Ym9hcmQiLCJ3YXRjaFNsaWRlc1Byb2dyZXNzIiwid2F0Y2hTbGlkZXNWaXNpYmlsaXR5Iiwic2xpZGVWaXNpYmxlQ2xhc3MiLCJpbml0Iiwic2xpZGVzIiwic2xpZGUiLCJ0YWJJbmRleCIsInNsaWRlQ2hhbmdlIiwiZXZlbnRzU3dpcGVyIiwiZXZlbnRzU2VlTW9yZUJ0biIsImV2ZW50c1NsaWRlciIsImFsbEV2ZW50cyIsImV2ZW50c1NsaWRlckZ1bmMiLCJ3aWR0aCIsIm1vYmlsZSIsImF1dG9IZWlnaHQiLCJjbGlja2FibGUiLCJidWxsZXRDbGFzcyIsImJ1bGxldEFjdGl2ZUNsYXNzIiwiYnVsbGV0RWxlbWVudCIsIm1vZGlmaWVyQ2xhc3MiLCJkZXN0cm95IiwidW5kZWZpbmVkIiwiZXZlbnRJdGVtIiwic3R5bGUiLCJkaXNwbGF5IiwiZWRpdGlvbnNTd2lwZXIiLCJlZGl0aW9uc1NsaWRlciIsImVkaXRpb25zU2xpZGVyRnVuYyIsInNwZWVkIiwic2xpZGVzUGVyQ29sdW1uIiwic2xpZGVzUGVyR3JvdXAiLCJzbGlkZXJzUGVyQ29sdW1uRmlsbCIsImJ0bnMiLCJtb2RhbE92ZXJsYXkiLCJtb2RhbHMiLCJtb2RhbENsb3NlQnRuIiwiZSIsImN1cnJlbnRUYXJnZXQiLCJnZXRBdHRyaWJ1dGUiLCJmaWx0ZXJzX19lbGVtZW50IiwiQ2hvaWNlcyIsInNlYXJjaEVuYWJsZWQiLCJpdGVtU2VsZWN0VGV4dCIsInBsYWNlaG9sZGVyIiwic2hvdWxkU29ydCIsInBvc2l0aW9uIiwidGFic0J0biIsInRhYkNvbnRlbnQiLCJ0YWJzIiwiYWNjb3JkaW9uIiwiY29sbGFwc2libGUiLCJpY29ucyIsImhlaWdodFN0eWxlIiwiZWRpdGlvbnNCdG4iLCJlZGl0aW9uc0l0ZW0iLCJlZGl0aW9uc0NoZWNrYm94IiwiZWRpdGlvbnNCdG5BcnJvdyIsImVkaXRpb25zQ2F0ZWdvcnlGdW5jIiwiYWN0aXZlRWxlbWVudCIsInBhcmVudEVsZW1lbnQiLCJwYXJlbnROb2RlIiwiY2hlY2tlZCIsIkFjdGl2ZUNoZWNrYm94IiwiX2xvb3AiLCJpIiwiRWRpdGlvbkNoZWNrZXIiLCJ0aXBweSIsImNvbnRlbnQiLCJyZWZlcmVuY2UiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsInRoZW1lIiwiYWxsb3dIVE1MIiwiYW5pbWF0aW9uIiwiaW50ZXJhY3RpdmUiLCJhcnJvdyIsInltYXBzIiwiTWFwIiwiY2VudGVyIiwiY29udHJvbHMiLCJ6b29tIiwic2VsZWN0b3IiLCJJbnB1dG1hc2siLCJtYXNrIiwiSnVzdFZhbGlkYXRlIiwicnVsZXMiLCJuYW1lIiwicmVxdWlyZWQiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJ0ZWwiLCJmdW5jdGlvbiIsInZhbHVlIiwiaW5wdXRtYXNrIiwidW5tYXNrZWR2YWx1ZSIsIk51bWJlciIsIm1lc3NhZ2VzIiwic3VibWl0SGFuZGxlciIsImZvcm0iLCJ2YWx1ZXMiLCJhamF4IiwidXJsIiwibWV0aG9kIiwiZGF0YSIsImFzeW5jIiwiY2FsbGJhY2siLCJfIl0sIm1hcHBpbmdzIjoiQUFBQSxhQ0FBQSxPQUFBQyxpQkFBQSxvQkFBQSxXQUVBQyxTQUFBQyxjQUFBLFdBQUFGLGlCQUFBLFNBQUEsV0FDQUMsU0FBQUMsY0FBQSxTQUFBQyxVQUFBQyxPQUFBLGtCQUNBLElBRUFILFNBQUFDLGNBQUEsZUFBQUYsaUJBQUEsU0FBQSxXQUNBQyxTQUFBQyxjQUFBLFNBQUFDLFVBQUFDLE9BQUEsa0JBQ0EsSUFHQUgsU0FBQUMsY0FBQSxXQUFBRixpQkFBQSxTQUFBLFdBQ0FDLFNBQ0FDLGNBQUEsZ0JBQ0FDLFVBQUFDLE9BQUEseUJBQ0EsSUFFQUgsU0FDQUMsY0FBQSxzQkFDQUYsaUJBQUEsU0FBQSxXQUNBQyxTQUNBQyxjQUFBLGdCQUNBQyxVQUFBQyxPQUFBLHlCQUNBLElBSUFDLEVBQUFKLFVBQUFLLE9BQUEsV0FDQUQsRUFBQSxTQUFBRSxHQUFBLFFBQUEsS0FBQSxTQUFBQyxHQUNBQSxFQUFBQyxpQkFFQSxJQUFBQyxFQUFBTCxFQUFBTSxNQUFBQyxLQUFBLFFBQ0FDLEVBQUFSLEVBQUFLLEdBQUFJLFNBQUFELElBRUFSLEVBQUEsYUFBQVUsUUFBQSxDQUFBQyxVQUFBSCxHQUFBLEtBQ0EsR0FDQSxJQUlBLElBQUFJLEVBQUEsQ0FDQUMsYUFBQSx5QkFDQUMsY0FBQSxpQkFDQUMsZ0JBQUEsWUFDQUMsa0JBQUEsZUFHQSxTQUFBQyxFQUFBQyxHQUNBQSxFQUFBQyxP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QSxJQUdBVCxNQUFBLGFBQUEsQ0FDQUMsUUFBQSxTQUFBQyxHQUNBLElBQUE1SCxFQUFBNEgsRUFBQTlCLGFBQUEsaUJBRUEsT0FEQXZHLFNBQUFzSSxlQUFBN0gsR0FDQThILFNBQ0EsRUFDQUMsTUFBQSxTQUNBQyxXQUFBLEVBQ0FDLFVBQUEsT0FDQUMsYUFBQSxFQUNBQyxPQUFBLElBR0FDLE1BQUF4SSxPQUNBLFdBQ0EsSUFBQXdJLE1BQUFDLElBQUEsTUFBQSxDQUNBQyxPQUFBLENBQUEsVUFBQSxXQUNBQyxTQUFBLEdBQ0FDLEtBQUEsSUFFQSxJQUdBLElBQUFDLEVBQUFsSixTQUFBQyxjQUFBLHFCQUNBLElBQUFrSixVQUFBLDRCQUVBQyxLQUFBRixHQUVBLElBQUFHLGFBQUEsUUFBQSxDQUNBQyxNQUFBLENBQ0FDLEtBQUEsQ0FDQUMsVUFBQSxFQUNBQyxVQUFBLEVBQ0FDLFVBQUEsSUFFQUMsSUFBQSxDQUNBSCxVQUFBLEVBQ0FJLFNBQUEsU0FBQUwsRUFBQU0sR0FDQSxJQUFBRixFQUFBVCxFQUFBWSxVQUFBQyxnQkFDQSxPQUFBQyxPQUFBTCxJQUFBLEtBQUFBLEVBQUE1SCxNQUNBLElBR0FrSSxTQUFBLENBQ0FWLEtBQUEsQ0FDQUMsU0FBQSx1Q0FDQUMsVUFBQSxpQ0FDQUMsVUFBQSxtQ0FFQUMsSUFBQSxDQUNBSCxTQUFBLHVDQUNBSSxTQUFBLHNDQUdBTSxjQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FBLEVBQUEsQ0FDQUMsSUFBQSw0Q0FDQUMsT0FBQSxPQUNBQyxLQUFBSixFQUNBSyxPQUFBLEVBQ0FDLFNBQUEsU0FBQUMsR0FDQTNLLFNBQUFDLGNBQ0EsbUNBQ0F1RixNQUFBQyxRQUFBLGNBQ0EsR0FFQSxJQUdBM0YsT0FBQUMsaUJBQUEsVUFBQSxTQUFBNEssR0FDQS9GLElBQ0E4QyxJQUNBOUIsR0FDQSxHQUNBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6W251bGwsIndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgLyogQnVyZ2VyICovXHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNidXJnZXJcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbWVudVwiKS5jbGFzc0xpc3QudG9nZ2xlKFwibWVudV9faXMtYWN0aXZlXCIpO1xyXG4gIH0pO1xyXG5cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Nsb3NlLW1lbnVcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbWVudVwiKS5jbGFzc0xpc3QudG9nZ2xlKFwibWVudV9faXMtYWN0aXZlXCIpO1xyXG4gIH0pO1xyXG5cclxuICAvKiBTZWFyY2ggKi9cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NlYXJjaFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjc2VhcmNoLW1lbnVcIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJzZWFyY2gtbWVudV9faXMtYWN0aXZlXCIpO1xyXG4gIH0pO1xyXG5cclxuICBkb2N1bWVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2xvc2Utc2VhcmNoLW1lbnVcIilcclxuICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBkb2N1bWVudFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI3NlYXJjaC1tZW51XCIpXHJcbiAgICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJzZWFyY2gtbWVudV9faXMtYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gIC8qIE1lbnUgKi9cclxuXHJcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgJChcIiNtZW51XCIpLm9uKFwiY2xpY2tcIiwgXCJhXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgdmFyIGlkID0gJCh0aGlzKS5hdHRyKFwiaHJlZlwiKSxcclxuICAgICAgICB0b3AgPSAkKGlkKS5vZmZzZXQoKS50b3A7XHJcblxyXG4gICAgICAkKFwiYm9keSxodG1sXCIpLmFuaW1hdGUoeyBzY3JvbGxUb3A6IHRvcCB9LCAxNTAwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvKiBNZW51IERyb3Bkb3duICovXHJcblxyXG4gIGNvbnN0IHBhcmFtcyA9IHtcclxuICAgIGJ0bkNsYXNzTmFtZTogXCJqcy1oZWFkZXItZHJvcGRvd24tYnRuXCIsXHJcbiAgICBkcm9wQ2xhc3NOYW1lOiBcImpzLWhlYWRlci1kcm9wXCIsXHJcbiAgICBhY3RpdmVDbGFzc05hbWU6IFwiaXMtYWN0aXZlXCIsXHJcbiAgICBkaXNhYmxlZENsYXNzTmFtZTogXCJpcy1kaXNhYmxlZFwiLFxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIG9uRGlzYWJsZShldnQpIHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhwYXJhbXMuZGlzYWJsZWRDbGFzc05hbWUpKSB7XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LnJlbW92ZShcclxuICAgICAgICBwYXJhbXMuZGlzYWJsZWRDbGFzc05hbWUsXHJcbiAgICAgICAgcGFyYW1zLmFjdGl2ZUNsYXNzTmFtZVxyXG4gICAgICApO1xyXG4gICAgICBldnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgb25EaXNhYmxlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNldE1lbnVMaXN0ZW5lcigpIHtcclxuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgY29uc3QgYWN0aXZlRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICAgIGAuJHtwYXJhbXMuYnRuQ2xhc3NOYW1lfS4ke3BhcmFtcy5hY3RpdmVDbGFzc05hbWV9LCAuJHtwYXJhbXMuZHJvcENsYXNzTmFtZX0uJHtwYXJhbXMuYWN0aXZlQ2xhc3NOYW1lfWBcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmIChcclxuICAgICAgICBhY3RpdmVFbGVtZW50cy5sZW5ndGggJiZcclxuICAgICAgICAhZXZ0LnRhcmdldC5jbG9zZXN0KGAuJHtwYXJhbXMuYWN0aXZlQ2xhc3NOYW1lfWApXHJcbiAgICAgICkge1xyXG4gICAgICAgIGFjdGl2ZUVsZW1lbnRzLmZvckVhY2goKGN1cnJlbnQpID0+IHtcclxuICAgICAgICAgIGlmIChjdXJyZW50LmNsYXNzTGlzdC5jb250YWlucyhwYXJhbXMuYnRuQ2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5yZW1vdmUocGFyYW1zLmFjdGl2ZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQocGFyYW1zLmRpc2FibGVkQ2xhc3NOYW1lKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xvc2VzdChgLiR7cGFyYW1zLmJ0bkNsYXNzTmFtZX1gKSkge1xyXG4gICAgICAgIGNvbnN0IGJ0biA9IGV2dC50YXJnZXQuY2xvc2VzdChgLiR7cGFyYW1zLmJ0bkNsYXNzTmFtZX1gKTtcclxuICAgICAgICBjb25zdCBwYXRoID0gYnRuLmRhdGFzZXQucGF0aDtcclxuICAgICAgICBjb25zdCBkcm9wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgIGAuJHtwYXJhbXMuZHJvcENsYXNzTmFtZX1bZGF0YS10YXJnZXQ9XCIke3BhdGh9XCJdYFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGJ0bi5jbGFzc0xpc3QudG9nZ2xlKHBhcmFtcy5hY3RpdmVDbGFzc05hbWUpO1xyXG5cclxuICAgICAgICBpZiAoIWRyb3AuY2xhc3NMaXN0LmNvbnRhaW5zKHBhcmFtcy5hY3RpdmVDbGFzc05hbWUpKSB7XHJcbiAgICAgICAgICBkcm9wLmNsYXNzTGlzdC5hZGQocGFyYW1zLmFjdGl2ZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgICBkcm9wLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgb25EaXNhYmxlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZHJvcC5jbGFzc0xpc3QuYWRkKHBhcmFtcy5kaXNhYmxlZENsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldE1lbnVMaXN0ZW5lcigpO1xyXG5cclxuICAkKFwiLnNlYXJjaC1pbnB1dFwiKS5mb2N1cyhmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHRoaXMpLnJlbW92ZUF0dHIoXCJwbGFjZWhvbGRlclwiKTtcclxuICB9KTtcclxuXHJcbiAgJChcIi5zZWFyY2gtaW5wdXRcIikuYmx1cihmdW5jdGlvbiAoKSB7XHJcbiAgICAkKHRoaXMpLmF0dHIoXCJwbGFjZWhvbGRlclwiLCBcItCf0L7QuNGB0Log0L/QviDRgdCw0LnRgtGDXCIpO1xyXG4gIH0pO1xyXG5cclxuICAvKiBTd2lwZXIgKi9cclxuXHJcbiAgY29uc3QgaGVyb19fc3dpcGVyID0gbmV3IFN3aXBlcihcIi5oZXJvX19zd2lwZXJcIiwge1xyXG4gICAgZGlyZWN0aW9uOiBcImhvcml6b250YWxcIixcclxuICAgIGxvb3A6IHRydWUsXHJcblxyXG4gICAgYWxsb3dUb3VjaE1vdmU6IGZhbHNlLFxyXG5cclxuICAgIGVmZmVjdDogXCJmYWRlXCIsXHJcblxyXG4gICAgYXV0b3BsYXk6IHtcclxuICAgICAgZGVsYXk6IDcwMDAsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBnYWxsZXJ5U2xpZGVyID0gbmV3IFN3aXBlcihcIi5nYWxsZXJ5X19zbGlkZXMtY29udGFpbmVyXCIsIHtcclxuICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICBncmlkOiB7XHJcbiAgICAgIHJvd3M6IDEsXHJcbiAgICAgIGZpbGw6IFwicm93XCIsXHJcbiAgICB9LFxyXG4gICAgc3BhY2VCZXR3ZWVuOiAyMCxcclxuICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgZWw6IFwiLmdhbGxlcnlfX3N3aXBlci1wYWdpbmF0aW9uXCIsXHJcbiAgICAgIHR5cGU6IFwiZnJhY3Rpb25cIixcclxuICAgIH0sXHJcbiAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgIG5leHRFbDogXCIuc3dpcGVyLWJ0bi1uZXh0XCIsXHJcbiAgICAgIHByZXZFbDogXCIuc3dpcGVyLWJ0bi1wcmV2XCIsXHJcbiAgICB9LFxyXG5cclxuICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgIDQ0MDoge1xyXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDIsXHJcbiAgICAgICAgZ3JpZDoge1xyXG4gICAgICAgICAgcm93czogMixcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogMzAsXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAxMjAwOiB7XHJcbiAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICBncmlkOiB7XHJcbiAgICAgICAgICByb3dzOiAyLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3BhY2VCZXR3ZWVuOiA1MCxcclxuICAgICAgfSxcclxuICAgIH0sXHJcblxyXG4gICAgYTExeTogZmFsc2UsXHJcbiAgICBrZXlib2FyZDogdHJ1ZSxcclxuXHJcbiAgICB3YXRjaFNsaWRlc1Byb2dyZXNzOiB0cnVlLFxyXG4gICAgd2F0Y2hTbGlkZXNWaXNpYmlsaXR5OiB0cnVlLFxyXG4gICAgc2xpZGVWaXNpYmxlQ2xhc3M6IFwic2xpZGUtdmlzaWJsZVwiLFxyXG5cclxuICAgIG9uOiB7XHJcbiAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNsaWRlcy5mb3JFYWNoKChzbGlkZSkgPT4ge1xyXG4gICAgICAgICAgaWYgKCFzbGlkZS5jbGFzc0xpc3QuY29udGFpbnMoXCJzbGlkZS12aXNpYmxlXCIpKSB7XHJcbiAgICAgICAgICAgIHNsaWRlLnRhYkluZGV4ID0gXCItMVwiO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc2xpZGUudGFiSW5kZXggPSBcIlwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG4gICAgICBzbGlkZUNoYW5nZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2xpZGVzLmZvckVhY2goKHNsaWRlKSA9PiB7XHJcbiAgICAgICAgICBpZiAoIXNsaWRlLmNsYXNzTGlzdC5jb250YWlucyhcInNsaWRlLXZpc2libGVcIikpIHtcclxuICAgICAgICAgICAgc2xpZGUudGFiSW5kZXggPSBcIi0xXCI7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzbGlkZS50YWJJbmRleCA9IFwiXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICBsZXQgZXZlbnRzU2VlTW9yZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZXZlbnRzX19idG5cIik7XHJcbiAgbGV0IGV2ZW50c1NsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZXZlbnRzX19zd2lwZXJcIik7XHJcbiAgbGV0IGFsbEV2ZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZXZlbnRzX19zd2lwZXItY2FyZC13cmFwXCIpO1xyXG4gIGV2ZW50c1NlZU1vcmVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIGFsbEV2ZW50cy5mb3JFYWNoKChldmVudEl0ZW0pID0+IHtcclxuICAgICAgZXZlbnRJdGVtLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIH0pO1xyXG5cclxuICBsZXQgZXZlbnRzU3dpcGVyO1xyXG5cclxuICBldmVudHNTbGlkZXIuZGF0YXNldC5tb2JpbGUgPSBmYWxzZTtcclxuICBmdW5jdGlvbiBldmVudHNTbGlkZXJGdW5jKCkge1xyXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNzMyICYmIGV2ZW50c1NsaWRlci5kYXRhc2V0Lm1vYmlsZSA9PSBcImZhbHNlXCIpIHtcclxuICAgICAgZXZlbnRzU3dpcGVyID0gbmV3IFN3aXBlcihldmVudHNTbGlkZXIsIHtcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogMjAsXHJcbiAgICAgICAgYXV0b0hlaWdodDogdHJ1ZSxcclxuICAgICAgICBwYWdpbmF0aW9uOiB7XHJcbiAgICAgICAgICBlbDogXCIuZXZlbnRzX19zd2lwZXItcGFnaW5hdGlvblwiLFxyXG4gICAgICAgICAgY2xpY2thYmxlOiB0cnVlLFxyXG4gICAgICAgICAgYnVsbGV0Q2xhc3M6IFwiZXZlbnRzX19zd2lwZXItcGFnaW5hdGlvbi1pdGVtXCIsXHJcbiAgICAgICAgICBidWxsZXRBY3RpdmVDbGFzczogXCJldmVudHNfX3N3aXBlci1wYWdpbmF0aW9uLWl0ZW0tYWN0aXZlXCIsXHJcbiAgICAgICAgICBidWxsZXRFbGVtZW50OiBcImxpXCIsXHJcbiAgICAgICAgICBtb2RpZmllckNsYXNzOiBcImV2ZW50cy1uYXYtXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICAgIGV2ZW50c1NsaWRlci5kYXRhc2V0Lm1vYmlsZSA9IFwidHJ1ZVwiO1xyXG4gICAgfVxyXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpID49IDczMiAmJiBldmVudHNTbGlkZXIuZGF0YXNldC5tb2JpbGUgPT0gXCJ0cnVlXCIpIHtcclxuICAgICAgZXZlbnRzU2xpZGVyLmRhdGFzZXQubW9iaWxlID0gXCJmYWxzZVwiO1xyXG4gICAgICBpZiAoZXZlbnRzU2xpZGVyLmNsYXNzTGlzdC5jb250YWlucyhcInN3aXBlci1pbml0aWFsaXplZFwiKSkge1xyXG4gICAgICAgIC8vIGRlc3Ryb3kgaXMgYSBTd2lwZXIncyBtZXRob2RcclxuICAgICAgICBldmVudHNTd2lwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIC8vIHJlc2V0IHZhcmlhYmxlIHZhbHVlXHJcbiAgICAgICAgZXZlbnRzU3dpcGVyID0gdW5kZWZpbmVkO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBldmVudHNTbGlkZXJGdW5jKCk7XHJcblxyXG4gIGxldCBlZGl0aW9uc1NsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdGlvbnNfX3N3aXBlci13cmFwXCIpO1xyXG4gIGxldCBlZGl0aW9uc1N3aXBlcjtcclxuXHJcbiAgZWRpdGlvbnNTbGlkZXIuZGF0YXNldC5tb2JpbGUgPSBmYWxzZTtcclxuICBmdW5jdGlvbiBlZGl0aW9uc1NsaWRlckZ1bmMoKSB7XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPj0gNjEwICYmIGVkaXRpb25zU2xpZGVyLmRhdGFzZXQubW9iaWxlID09IFwiZmFsc2VcIikge1xyXG4gICAgICBlZGl0aW9uc1N3aXBlciA9IG5ldyBTd2lwZXIoXCIuZWRpdGlvbnNfX3N3aXBlci13cmFwXCIsIHtcclxuICAgICAgICBkaXJlY3Rpb246IFwiaG9yaXpvbnRhbFwiLFxyXG4gICAgICAgIGxvb3A6IGZhbHNlLFxyXG5cclxuICAgICAgICBhbGxvd1RvdWNoTW92ZTogZmFsc2UsXHJcblxyXG4gICAgICAgIHNwZWVkOiAxMDAwLFxyXG5cclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICBuZXh0RWw6IFwiLmVkaXRpb25zX19zd2lwZXItYnV0dG9uLW5leHRcIixcclxuICAgICAgICAgIHByZXZFbDogXCIuZWRpdGlvbnNfX3N3aXBlci1idXR0b24tcHJldlwiLFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHBhZ2luYXRpb246IHtcclxuICAgICAgICAgIGVsOiBcIi5lZGl0aW9uc19fc3dpcGVyLXBhZ2luYXRpb25cIixcclxuICAgICAgICAgIHR5cGU6IFwiZnJhY3Rpb25cIixcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICAgIHNsaWRlc1BlckNvbHVtbjogMSxcclxuICAgICAgICBzbGlkZXNQZXJHcm91cDogMSxcclxuICAgICAgICBzcGFjZUJldHdlZW46IDM0LFxyXG4gICAgICAgIHNsaWRlcnNQZXJDb2x1bW5GaWxsOiBcInJvd1wiLFxyXG5cclxuICAgICAgICBicmVha3BvaW50czoge1xyXG4gICAgICAgICAgMTAyNDoge1xyXG4gICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICAgICAgICBzcGFjZUJldHdlZW46IDUwLFxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAxMjgwOiB7XHJcbiAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDMsXHJcbiAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogNTAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgICBlZGl0aW9uc1NsaWRlci5kYXRhc2V0Lm1vYmlsZSA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPCA2MTAgJiYgZWRpdGlvbnNTbGlkZXIuZGF0YXNldC5tb2JpbGUgPT0gXCJ0cnVlXCIpIHtcclxuICAgICAgZWRpdGlvbnNTbGlkZXIuZGF0YXNldC5tb2JpbGUgPSBcImZhbHNlXCI7XHJcbiAgICAgIGlmIChlZGl0aW9uc1NsaWRlci5jbGFzc0xpc3QuY29udGFpbnMoXCJzd2lwZXItaW5pdGlhbGl6ZWRcIikpIHtcclxuICAgICAgICAvLyBkZXN0cm95IGlzIGEgU3dpcGVyJ3MgbWV0aG9kXHJcbiAgICAgICAgZWRpdGlvbnNTd2lwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIC8vIHJlc2V0IHZhcmlhYmxlIHZhbHVlXHJcbiAgICAgICAgZWRpdGlvbnNTd2lwZXIgPSB1bmRlZmluZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGVkaXRpb25zU2xpZGVyRnVuYygpO1xyXG5cclxuICBjb25zdCBwcm9qZWN0X3BhcnRuZXJzID0gbmV3IFN3aXBlcihcIi5wcm9qZWN0LXBhcnRuZXJzX19zd2lwZXJcIiwge1xyXG4gICAgZGlyZWN0aW9uOiBcImhvcml6b250YWxcIixcclxuICAgIGxvb3A6IGZhbHNlLFxyXG5cclxuICAgIGFsbG93VG91Y2hNb3ZlOiBmYWxzZSxcclxuXHJcbiAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgIG5leHRFbDogXCIucHJvamVjdC1wYXJ0bmVyc19fc3dpcGVyLWJ1dHRvbi1uZXh0XCIsXHJcbiAgICAgIHByZXZFbDogXCIucHJvamVjdC1wYXJ0bmVyc19fc3dpcGVyLWJ1dHRvbi1wcmV2XCIsXHJcbiAgICB9LFxyXG5cclxuICAgIHNwZWVkOiAxMDAwLFxyXG5cclxuICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICBzbGlkZXNQZXJDb2x1bW46IDEsXHJcbiAgICBzbGlkZXNQZXJHcm91cDogMSxcclxuICAgIHNsaWRlcnNQZXJDb2x1bW5GaWxsOiBcInJvd1wiLFxyXG5cclxuICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgIDU5MDoge1xyXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDIsXHJcbiAgICAgICAgc3BhY2VCZXR3ZWVuOiAzNCxcclxuICAgICAgfSxcclxuXHJcbiAgICAgIDEwMjQ6IHtcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiAyLFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogNTAsXHJcbiAgICAgIH0sXHJcblxyXG4gICAgICAxNDQwOiB7XHJcbiAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICBzcGFjZUJldHdlZW46IDUwLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICB9KTtcclxuXHJcbiAgLyogTW9kYWxzICovXHJcbiAgY29uc3QgYnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZ2FsbGVyeV9fc3dpcGVyLXNsaWRlXCIpO1xyXG4gIGNvbnN0IG1vZGFsT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fbW9kYWwtb3ZlcmxheVwiKTtcclxuICBjb25zdCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xyXG4gIGNvbnN0IG1vZGFsQ2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcblxyXG4gIGJ0bnMuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBsZXQgcGF0aCA9IGUuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXBhdGhcIik7XHJcblxyXG4gICAgICBtb2RhbHMuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWwtLXZpc2libGVcIik7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZG9jdW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihgW2RhdGEtdGFyZ2V0PVwiJHtwYXRofVwiXWApXHJcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJtb2RhbC0tdmlzaWJsZVwiKTtcclxuICAgICAgbW9kYWxPdmVybGF5LmNsYXNzTGlzdC5hZGQoXCJnYWxsZXJ5X19tb2RhbC1vdmVybGF5LS12aXNpYmxlXCIpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIG1vZGFsT3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIGlmIChlLnRhcmdldCA9PSBtb2RhbE92ZXJsYXkpIHtcclxuICAgICAgbW9kYWxPdmVybGF5LmNsYXNzTGlzdC5yZW1vdmUoXCJnYWxsZXJ5X19tb2RhbC1vdmVybGF5LS12aXNpYmxlXCIpO1xyXG5cclxuICAgICAgbW9kYWxzLmZvckVhY2goKGVsKSA9PiB7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLS12aXNpYmxlXCIpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgbW9kYWxDbG9zZUJ0bi5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIG1vZGFsT3ZlcmxheS5jbGFzc0xpc3QucmVtb3ZlKFwiZ2FsbGVyeV9fbW9kYWwtb3ZlcmxheS0tdmlzaWJsZVwiKTtcclxuXHJcbiAgICAgIG1vZGFscy5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbC0tdmlzaWJsZVwiKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLyogQ2hvaWNlcyAqL1xyXG4gIHZhciBmaWx0ZXJzX19lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIFwiLmdhbGxlcnlfX2ZpbHRlcnMtc2VsZWN0LWVsZW1lbnRzXCJcclxuICApO1xyXG4gIHZhciBmaWx0ZXJzX19jaG9pY2VzID0gbmV3IENob2ljZXMoZmlsdGVyc19fZWxlbWVudCwge1xyXG4gICAgc2VhcmNoRW5hYmxlZDogZmFsc2UsXHJcbiAgICBpdGVtU2VsZWN0VGV4dDogXCJcIixcclxuICAgIHBsYWNlaG9sZGVyOiB0cnVlLFxyXG4gICAgc2hvdWxkU29ydDogZmFsc2UsXHJcbiAgICBwb3NpdGlvbjogXCJib3R0b21cIixcclxuICB9KTtcclxuXHJcbiAgLyogQ2F0YWxvZyAqL1xyXG4gIC8qIFRhYnMgKi9cclxuICBkb2N1bWVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZ19fYWNjb3JkaW9uLWluZm9ybWF0aW9uLWxpbmtcIilcclxuICAgIC5mb3JFYWNoKGZ1bmN0aW9uICh0YWJzQnRuKSB7XHJcbiAgICAgIHRhYnNCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQuZGF0YXNldC5wYXRoO1xyXG5cclxuICAgICAgICBkb2N1bWVudFxyXG4gICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY2F0YWxvZ19fYXJ0aXN0XCIpXHJcbiAgICAgICAgICAuZm9yRWFjaChmdW5jdGlvbiAodGFiQ29udGVudCkge1xyXG4gICAgICAgICAgICB0YWJDb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWItY29udGVudC1hY3RpdmVcIik7XHJcblxyXG4gICAgICAgICAgICBkb2N1bWVudFxyXG4gICAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNhdGFsb2dfX2FjY29yZGlvbi1pbmZvcm1hdGlvbi1saW5rXCIpXHJcbiAgICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKHRhYnMpIHtcclxuICAgICAgICAgICAgICAgIHRhYnMuY2xhc3NMaXN0LnJlbW92ZShcInRhYi1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZG9jdW1lbnRcclxuICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10YXJnZXQ9XCIke3BhdGh9XCJdYClcclxuICAgICAgICAgIC5jbGFzc0xpc3QuYWRkKFwidGFiLWNvbnRlbnQtYWN0aXZlXCIpO1xyXG4gICAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgICAucXVlcnlTZWxlY3RvcihgW2RhdGEtcGF0aD1cIiR7cGF0aH1cIl1gKVxyXG4gICAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJ0YWItYWN0aXZlXCIpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAvKiBBY2NvcmRpb24gKi9cclxuXHJcbiAgJChmdW5jdGlvbiAoKSB7XHJcbiAgICAkKFwiI2FjY29yZGlvblwiKS5hY2NvcmRpb24oe1xyXG4gICAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcclxuICAgICAgaWNvbnM6IGZhbHNlLFxyXG4gICAgICBoZWlnaHRTdHlsZTogXCJjb250ZW50XCIsXHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLyogRWRpdGlvbnMgKi9cclxuICBjb25zdCBlZGl0aW9uc0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdGlvbnNfX2NhdGVnb3J5LWJ0blwiKTtcclxuICBjb25zdCBlZGl0aW9uc0l0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgXCIuZWRpdGlvbnNfX2NhdGVnb3J5LWNvbnRlbnQtaXRlbVwiXHJcbiAgKTtcclxuICBjb25zdCBlZGl0aW9uc0NoZWNrYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcclxuICAgIFwiLmVkaXRpb25zX19jYXRlZ29yeS1jb250ZW50LWNoZWNrYm94XCJcclxuICApO1xyXG4gIGNvbnN0IGVkaXRpb25zQ2F0ZWdvcnlDb250ZW50Q2FiZWwgPSB0aGlzLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICBcImVkaXRpb25zX19jYXRlZ29yeS1jb250ZW50LWxhYmVsXCJcclxuICApO1xyXG4gIGNvbnN0IGVkaXRpb25zQnRuQXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXRpb25zX19idG4tYXJyb3dcIik7XHJcblxyXG4gIGZ1bmN0aW9uIGVkaXRpb25zQ2F0ZWdvcnlGdW5jKCkge1xyXG4gICAgaWYgKCQod2luZG93KS53aWR0aCgpID49IDYxMCkge1xyXG4gICAgICBlZGl0aW9uc0NoZWNrYm94LmZvckVhY2goKGVsKSA9PiB7XHJcbiAgICAgICAgaWYgKGVsLmFjdGl2ZUVsZW1lbnQgPT09IHRydWUpIHtcclxuICAgICAgICAgIGVsLnBhcmVudEVsZW1lbnQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKFxyXG4gICAgICAgICAgICBcImVkaXRpb25zX19jYXRlZ29yeS1jb250ZW50LWl0ZW0tYWN0aXZlLWNvbG9yXCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChlbC5jaGVja2VkID09PSB0cnVlKSB7XHJcbiAgICAgICAgICBlbC5wYXJlbnRFbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICAgICAgXCJlZGl0aW9uc19fY2F0ZWdvcnktY29udGVudC1pdGVtLWFjdGl2ZS1jb2xvclwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBlbC5wYXJlbnRFbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZShcclxuICAgICAgICAgICAgXCJlZGl0aW9uc19fY2F0ZWdvcnktY29udGVudC1pdGVtLWFjdGl2ZS1jb2xvclwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBsZXQgQWN0aXZlQ2hlY2tib3ggPSAoKSA9PiB7XHJcbiAgICAgIGVkaXRpb25zQ2hlY2tib3guZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgICBpZiAoZWwuY2hlY2tlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgZWwucGFyZW50RWxlbWVudC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgICAgICAgIFwiZWRpdGlvbnNfX2NhdGVnb3J5LWNvbnRlbnQtaXRlbS1hY3RpdmVcIixcclxuICAgICAgICAgICAgXCJlZGl0aW9uc19fY2F0ZWdvcnktY29udGVudC1pdGVtLWFjdGl2ZS1jb2xvclwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxldCBFZGl0aW9uc0FjY29yZGlvbiA9ICgpID0+IHtcclxuICAgICAgZWRpdGlvbnNCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBlZGl0aW9uc0J0bkFycm93LmNsYXNzTGlzdC50b2dnbGUoXCJlZGl0aW9uc19fYnRuLWFycm93LWFjdGl2ZVwiKTtcclxuICAgICAgICBlZGl0aW9uc0l0ZW0uZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgICAgIGVsLmNsYXNzTGlzdC50b2dnbGUoXCJlZGl0aW9uc19fY2F0ZWdvcnktY29udGVudC1pdGVtLWFjdGl2ZVwiKTtcclxuICAgICAgICAgIEFjdGl2ZUNoZWNrYm94KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgRWRpdGlvbkNoZWNrZXIgPSAoKSA9PiB7XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWRpdGlvbnNDaGVja2JveC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGVsID0gZWRpdGlvbnNDaGVja2JveFtpXTtcclxuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgIWVsLmNoZWNrZWQgJiZcclxuICAgICAgICAgICAgIWVkaXRpb25zQnRuQXJyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZWRpdGlvbnNfX2J0bi1hcnJvdy1hY3RpdmVcIilcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBlbC5wYXJlbnRFbGVtZW50LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZShcclxuICAgICAgICAgICAgICBcImVkaXRpb25zX19jYXRlZ29yeS1jb250ZW50LWl0ZW0tYWN0aXZlXCIsXHJcbiAgICAgICAgICAgICAgXCJlZGl0aW9uc19fY2F0ZWdvcnktY29udGVudC1pdGVtLWFjdGl2ZS1jb2xvclwiXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBBY3RpdmVDaGVja2JveCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIEFjdGl2ZUNoZWNrYm94KCk7XHJcbiAgICB9O1xyXG4gICAgRWRpdGlvbnNBY2NvcmRpb24oKTtcclxuICAgIEVkaXRpb25DaGVja2VyKCk7XHJcbiAgfVxyXG5cclxuICBlZGl0aW9uc0NhdGVnb3J5RnVuYygpO1xyXG5cclxuICAvLyBUb29sdGlwXHJcblxyXG4gIHRpcHB5KFwiI3Rvb2x0aXAtMVwiLCB7XHJcbiAgICBjb250ZW50KHJlZmVyZW5jZSkge1xyXG4gICAgICBjb25zdCBpZCA9IHJlZmVyZW5jZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRlbXBsYXRlXCIpO1xyXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuICAgICAgcmV0dXJuIHRlbXBsYXRlLmlubmVySFRNTDtcclxuICAgIH0sXHJcbiAgICB0aGVtZTogXCJ0b21hdG9cIixcclxuICAgIGFsbG93SFRNTDogdHJ1ZSxcclxuICAgIGFuaW1hdGlvbjogXCJmYWRlXCIsXHJcbiAgICBpbnRlcmFjdGl2ZTogdHJ1ZSxcclxuICAgIGFycm93OiB0cnVlLFxyXG4gIH0pO1xyXG5cclxuICB0aXBweShcIiN0b29sdGlwLTJcIiwge1xyXG4gICAgY29udGVudChyZWZlcmVuY2UpIHtcclxuICAgICAgY29uc3QgaWQgPSByZWZlcmVuY2UuZ2V0QXR0cmlidXRlKFwiZGF0YS10ZW1wbGF0ZVwiKTtcclxuICAgICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICAgIHJldHVybiB0ZW1wbGF0ZS5pbm5lckhUTUw7XHJcbiAgICB9LFxyXG4gICAgdGhlbWU6IFwidG9tYXRvXCIsXHJcbiAgICBhbGxvd0hUTUw6IHRydWUsXHJcbiAgICBhbmltYXRpb246IFwiZmFkZVwiLFxyXG4gICAgaW50ZXJhY3RpdmU6IHRydWUsXHJcbiAgICBhcnJvdzogdHJ1ZSxcclxuICB9KTtcclxuXHJcbiAgdGlwcHkoXCIjdG9vbHRpcC0zXCIsIHtcclxuICAgIGNvbnRlbnQocmVmZXJlbmNlKSB7XHJcbiAgICAgIGNvbnN0IGlkID0gcmVmZXJlbmNlLmdldEF0dHJpYnV0ZShcImRhdGEtdGVtcGxhdGVcIik7XHJcbiAgICAgIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG4gICAgICByZXR1cm4gdGVtcGxhdGUuaW5uZXJIVE1MO1xyXG4gICAgfSxcclxuICAgIHRoZW1lOiBcInRvbWF0b1wiLFxyXG4gICAgYWxsb3dIVE1MOiB0cnVlLFxyXG4gICAgYW5pbWF0aW9uOiBcImZhZGVcIixcclxuICAgIGludGVyYWN0aXZlOiB0cnVlLFxyXG4gICAgYXJyb3c6IHRydWUsXHJcbiAgfSk7XHJcblxyXG4gIHltYXBzLnJlYWR5KGluaXQpO1xyXG4gIGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICB2YXIgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuICAgICAgY2VudGVyOiBbNTUuNzU4NDY4LCAzNy42MDEwODhdLFxyXG4gICAgICBjb250cm9sczogW10sXHJcbiAgICAgIHpvb206IDE1LFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKiBGb3JtICovXHJcbiAgdmFyIHNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W3R5cGU9J3RlbCddXCIpO1xyXG4gIHZhciBpbSA9IG5ldyBJbnB1dG1hc2soXCIrNyAoOTk5KSAtIDk5OSAtIDk5IC0gOTlcIik7XHJcblxyXG4gIGltLm1hc2soc2VsZWN0b3IpO1xyXG5cclxuICBuZXcgSnVzdFZhbGlkYXRlKFwiI2Zvcm1cIiwge1xyXG4gICAgcnVsZXM6IHtcclxuICAgICAgbmFtZToge1xyXG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgIG1pbkxlbmd0aDogMixcclxuICAgICAgICBtYXhMZW5ndGg6IDIwLFxyXG4gICAgICB9LFxyXG4gICAgICB0ZWw6IHtcclxuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICBmdW5jdGlvbjogKG5hbWUsIHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCB0ZWwgPSBzZWxlY3Rvci5pbnB1dG1hc2sudW5tYXNrZWR2YWx1ZSgpO1xyXG4gICAgICAgICAgcmV0dXJuIE51bWJlcih0ZWwpICYmIHRlbC5sZW5ndGggPT09IDEwO1xyXG4gICAgICAgIH0sXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgbWVzc2FnZXM6IHtcclxuICAgICAgbmFtZToge1xyXG4gICAgICAgIHJlcXVpcmVkOiBcItCt0YLQviDQv9C+0LvQtSDQvtCx0Y/Qt9Cw0YLQtdC70YzQvdC+0LUg0LTQu9GPINC30LDQv9C+0LvQvdC10L3QuNGPXCIsXHJcbiAgICAgICAgbWluTGVuZ3RoOiBcItCS0Ysg0LLQstC10LvQuCDRgdC70LjRiNC60L7QvCDQvNCw0LvQviDRgdC40LzQstC+0LvQvtCyXCIsXHJcbiAgICAgICAgbWF4TGVuZ3RoOiBcItCS0Ysg0LLQstC10LvQuCDRgdC70LjRiNC60L7QvCDQvNC90L7Qs9C+INGB0LjQvNCy0L7Qu9C+0LJcIixcclxuICAgICAgfSxcclxuICAgICAgdGVsOiB7XHJcbiAgICAgICAgcmVxdWlyZWQ6IFwi0K3RgtC+INC/0L7Qu9C1INC+0LHRj9C30LDRgtC10LvRjNC90L7QtSDQtNC70Y8g0LfQsNC/0L7Qu9C90LXQvdC40Y9cIixcclxuICAgICAgICBmdW5jdGlvbjogXCLQktCy0LXQtNC40YLQtSDQutC+0YDRgNC10LrRgtC90YvQuSDQvdC+0LzQtdGAINGC0LXQu9C10YTQvtC90LBcIixcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBzdWJtaXRIYW5kbGVyOiBmdW5jdGlvbiAoZm9ybSwgdmFsdWVzLCBhamF4KSB7XHJcbiAgICAgIGFqYXgoe1xyXG4gICAgICAgIHVybDogXCJodHRwOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS9wb3N0c1wiLFxyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgZGF0YTogdmFsdWVzLFxyXG4gICAgICAgIGFzeW5jOiB0cnVlLFxyXG4gICAgICAgIGNhbGxiYWNrOiAoXykgPT4ge1xyXG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgICAgXCIuY29udGFjdHNfX2Zvcm0tc3VjY2Vzcy1tZXNzYWdlXCJcclxuICAgICAgICAgICkuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoXykgPT4ge1xyXG4gICAgZXZlbnRzU2xpZGVyRnVuYygpO1xyXG4gICAgZWRpdGlvbnNDYXRlZ29yeUZ1bmMoKTtcclxuICAgIGVkaXRpb25zU2xpZGVyRnVuYygpO1xyXG4gIH0pO1xyXG59KTtcclxuIl19
